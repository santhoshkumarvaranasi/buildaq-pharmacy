# System Architecture & Visual Diagrams

## ğŸ—ï¸ System Architecture

### High-Level Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PHARMACY SHELF MAPPING SYSTEM             â”‚
â”‚                    (Angular 17 Application)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚              â”‚              â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   User Layer   â”‚ â”‚   Services  â”‚ â”‚  Persistence     â”‚
        â”‚   (Components) â”‚ â”‚   Layer     â”‚ â”‚     Layer        â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚              â”‚                    â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚            â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Pharmacy      â”‚     â”‚            â”‚   LocalStorage   â”‚
        â”‚  Dashboard     â”‚     â”‚            â”‚   (Browser API)  â”‚
        â”‚  & 5 Tabs      â”‚     â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
                               â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚          â”‚           â”‚            â”‚          â”‚
        â–¼          â–¼           â–¼            â–¼          â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Visual  â”‚â”‚ Medicine â”‚â”‚  Shelf   â”‚â”‚ Product  â”‚â”‚ Order  â”‚
   â”‚ Space   â”‚â”‚Detection â”‚â”‚Managementâ”‚â”‚  List    â”‚â”‚Manage  â”‚
   â”‚ Mapper  â”‚â”‚Component â”‚â”‚Component â”‚â”‚Component â”‚â”‚Component
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚          â”‚           â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚     SERVICE LAYER (3 Services)    â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚ 1. ImageDetectionService            â”‚
        â”‚    - Detect objects with COCO-SSD   â”‚
        â”‚    - Process detection results      â”‚
        â”‚    - Manage loading state           â”‚
        â”‚                                     â”‚
        â”‚ 2. ShelfMappingService              â”‚
        â”‚    - Create visual spaces           â”‚
        â”‚    - Manage shelves                 â”‚
        â”‚    - Track medicine locations      â”‚
        â”‚    - Observable-based state         â”‚
        â”‚                                     â”‚
        â”‚ 3. MedicineService                  â”‚
        â”‚    - Medicine catalog               â”‚
        â”‚    - Search functionality           â”‚
        â”‚    - Category management            â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   EXTERNAL LIBRARIES               â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚ - TensorFlow.js 4.11               â”‚
        â”‚ - COCO-SSD Model                   â”‚
        â”‚ - Angular Material 17              â”‚
        â”‚ - RxJS 7.8                         â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Data Model Relationships

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      VISUAL SPACE                             â”‚
â”‚  {id, name, location, imageUrl, shelves[], createdDate}     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â–²
              â”‚
              â”‚ contains 1 or more
              â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚                                  â”‚
       â–¼                                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       SHELF 1                â”‚   â”‚       SHELF 2                â”‚
â”‚  {id, name, width, height,   â”‚   â”‚  {id, name, width, height,   â”‚
â”‚   medicines[], location}     â”‚   â”‚   medicines[], location}     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                                  â”‚
       â”‚ contains medicines               â”‚
       â”‚                                  â”‚
       â–¼                                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    MEDICINE 1                â”‚   â”‚    MEDICINE 2                â”‚
â”‚  {id, name, x, y,            â”‚   â”‚  {id, name, x, y,            â”‚
â”‚   width, height, confidence, â”‚   â”‚   width, height, confidence, â”‚
â”‚   barcode, detectionTime}    â”‚   â”‚   barcode, detectionTime}    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Data Flow Diagram

### Complete Request-Response Cycle

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              USER UPLOADS PHARMACY IMAGE                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  VisualSpaceMapperComponent    â”‚
        â”‚  - Handles file input          â”‚
        â”‚  - Shows preview               â”‚
        â”‚  - Triggers detection          â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ ImageDetectionService.         â”‚
        â”‚ detectMedicines(imageUrl)      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚    TensorFlow.js Loads         â”‚
        â”‚    COCO-SSD Model              â”‚
        â”‚    (~100MB first time)         â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   Run Detection on Image       â”‚
        â”‚   - Analyze image              â”‚
        â”‚   - Find objects               â”‚
        â”‚   - Calculate confidence       â”‚
        â”‚   - Generate bounding boxes    â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   Return DetectionResult       â”‚
        â”‚   {objects[], imageUrl,        â”‚
        â”‚    timestamp, dimensions}      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   Component Processes Results  â”‚
        â”‚   - Filter by confidence       â”‚
        â”‚   - Filter by class            â”‚
        â”‚   - Map to MedicineLocation    â”‚
        â”‚   - Display in table           â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                         â”‚
    â–¼                                         â–¼
USER REVIEWS                          USER ADDS TO SHELF
& FILTERS                             
    â”‚                                         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ ShelfMappingService.           â”‚
        â”‚ addMedicineToShelf()           â”‚
        â”‚ - Validate shelf exists        â”‚
        â”‚ - Create MedicineLocation      â”‚
        â”‚ - Add to shelf array           â”‚
        â”‚ - Update visual space          â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   Save to LocalStorage         â”‚
        â”‚   Key: 'visual_spaces'         â”‚
        â”‚   Value: JSON string           â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Update Component State        â”‚
        â”‚  - Emit Observable             â”‚
        â”‚  - Component subscribes        â”‚
        â”‚  - Update UI display           â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ DISPLAY IN SHELF MANAGEMENT    â”‚
        â”‚ - Show medicines               â”‚
        â”‚ - Show positions               â”‚
        â”‚ - Show statistics              â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¢ Component Hierarchy

```
AppComponent
    â”‚
    â””â”€â”€ AppRoutingModule
            â”‚
            â””â”€â”€ PharmacyModule
                    â”‚
                    â””â”€â”€ PharmacyDashboardComponent
                            â”‚
                            â”œâ”€â”€â”€ MatTabGroup
                            â”‚        â”‚
                            â”‚        â”œâ”€â”€ Tab 1: VisualSpaceMapperComponent
                            â”‚        â”‚        â”‚
                            â”‚        â”‚        â”œâ”€â”€ MatTabGroup
                            â”‚        â”‚        â”‚    â”œâ”€â”€ Upload Image Tab
                            â”‚        â”‚        â”‚    â””â”€â”€ Manage Shelves Tab
                            â”‚        â”‚        â”‚
                            â”‚        â”‚        â””â”€â”€ MatCardGroup (All Spaces)
                            â”‚        â”‚
                            â”‚        â”œâ”€â”€ Tab 2: MedicineDetectionComponent
                            â”‚        â”‚        â”‚
                            â”‚        â”‚        â”œâ”€â”€ MatExpansionPanel
                            â”‚        â”‚        â”‚    â””â”€â”€ Detection Settings
                            â”‚        â”‚        â”‚
                            â”‚        â”‚        â”œâ”€â”€ MatTable
                            â”‚        â”‚        â”‚    â””â”€â”€ Detected Medicines
                            â”‚        â”‚        â”‚
                            â”‚        â”‚        â””â”€â”€ Summary Card
                            â”‚        â”‚
                            â”‚        â”œâ”€â”€ Tab 3: ShelfManagementComponent
                            â”‚        â”‚        â”‚
                            â”‚        â”‚        â”œâ”€â”€ Locations Panel (Left)
                            â”‚        â”‚        â”‚    â””â”€â”€ MatList
                            â”‚        â”‚        â”‚
                            â”‚        â”‚        â”œâ”€â”€ Shelves Panel (Center)
                            â”‚        â”‚        â”‚    â””â”€â”€ MatList
                            â”‚        â”‚        â”‚
                            â”‚        â”‚        â””â”€â”€ Medicines Panel (Right)
                            â”‚        â”‚             â”œâ”€â”€ Statistics Cards
                            â”‚        â”‚             â””â”€â”€ MatTable
                            â”‚        â”‚
                            â”‚        â”œâ”€â”€ Tab 4: ProductListComponent
                            â”‚        â”‚
                            â”‚        â””â”€â”€ Tab 5: OrderManagementComponent
                            â”‚
                            â””â”€â”€ [Router Outlet for Tab Content]
```

---

## ğŸ“¡ Service Communication Pattern

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Components          â”‚
â”‚ (Subscribe to services)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚  RxJS Observables â”‚
     â”‚  (Subjects)       â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚         Service Layer                 â”‚
     â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
     â”‚ â”‚ ImageDetectionService            â”‚  â”‚
     â”‚ â”‚ - detectionResults$ BehaviorSubj â”‚  â”‚
     â”‚ â”‚ - isLoading$ BehaviorSubj        â”‚  â”‚
     â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
     â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
     â”‚ â”‚ ShelfMappingService              â”‚  â”‚
     â”‚ â”‚ - visualSpaces$ BehaviorSubj     â”‚  â”‚
     â”‚ â”‚ - currentVisualSpace$ BehaviorSu â”‚  â”‚
     â”‚ â”‚ - currentShelf$ BehaviorSubj     â”‚  â”‚
     â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
     â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
     â”‚ â”‚ MedicineService                  â”‚  â”‚
     â”‚ â”‚ - medicines$ BehaviorSubj        â”‚  â”‚
     â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚   External Libraries          â”‚
     â”‚ - TensorFlow.js               â”‚
     â”‚ - LocalStorage API            â”‚
     â”‚ - Angular Material            â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ–¼ï¸ UI Layout Structure

### Main Dashboard

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PHARMACY SHELF MAPPING SYSTEM                              â”‚
â”‚  Identify medicines and manage their placement in shelves   â”‚
â”‚  [Gradient Background: Purple to Blue]                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”â”‚
â”‚  â”‚ Visual      â”‚ Medicine     â”‚ Shelf        â”‚Product  â”‚Ordâ”‚â”‚
â”‚  â”‚ Mapper      â”‚ Detection    â”‚Management    â”‚List     â”‚er â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”˜â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  [Tab Content Area - 600px+ min height]                  â”‚â”‚
â”‚  â”‚                                                            â”‚â”‚
â”‚  â”‚  Tab 1: Visual Space Mapper                              â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚â”‚
â”‚  â”‚  â”‚ [ Upload Image ] [ Image Preview Canvas ]        â”‚    â”‚â”‚
â”‚  â”‚  â”‚ [ Create Visual Space Button ]                   â”‚    â”‚â”‚
â”‚  â”‚  â”‚ [ All Spaces List with Edit/Delete ]            â”‚    â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚â”‚
â”‚  â”‚                                                            â”‚â”‚
â”‚  â”‚  Tab 2: Medicine Detection                              â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚â”‚
â”‚  â”‚  â”‚ [ Detection Settings Panel ]                     â”‚    â”‚â”‚
â”‚  â”‚  â”‚ [ Detected Medicines Table ]                     â”‚    â”‚â”‚
â”‚  â”‚  â”‚ [ Add/Remove buttons ]                           â”‚    â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚â”‚
â”‚  â”‚                                                            â”‚â”‚
â”‚  â”‚  Tab 3: Shelf Management                                â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚â”‚
â”‚  â”‚  â”‚Locations â”‚  Shelves   â”‚ Medicines & Statistics   â”‚   â”‚â”‚
â”‚  â”‚  â”‚ (Left)   â”‚  (Center)  â”‚ (Right)                  â”‚   â”‚â”‚
â”‚  â”‚  â”‚ Panel    â”‚  Panel     â”‚ Panel                    â”‚   â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚â”‚
â”‚  â”‚                                                            â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Shelf Management Layout (Tab 3 Detail)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              SHELF MANAGEMENT CONTENT               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   LOCATIONS      â”‚   SHELVES       â”‚  MEDICINES    â”‚
â”‚   (Left Panel)   â”‚  (Mid Panel)    â”‚  (Right Panel)â”‚
â”‚                  â”‚                 â”‚               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ Aisle 1    â”‚  â”‚ â”‚ Shelf A1  â”‚  â”‚ â”‚Statistics â”‚â”‚
â”‚  â”‚ (2 shelves)â”‚  â”‚ â”‚ 100x50cm  â”‚  â”‚ â”‚           â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚ 5 meds    â”‚  â”‚ â”‚ Medicines:â”‚â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚ 5         â”‚â”‚
â”‚  â”‚ Aisle 2    â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚ Avg Conf: â”‚â”‚
â”‚  â”‚ (3 shelves)â”‚  â”‚ â”‚ Shelf A2  â”‚  â”‚ â”‚ 87.2%     â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚ 100x50cm  â”‚  â”‚ â”‚ Size:     â”‚â”‚
â”‚                  â”‚ â”‚ 3 meds    â”‚  â”‚ â”‚ 100x50cm  â”‚â”‚
â”‚                  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                  â”‚                 â”‚               â”‚
â”‚                  â”‚                 â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚                  â”‚                 â”‚ â”‚ Medicines â”‚â”‚
â”‚                  â”‚                 â”‚ â”‚ Table     â”‚â”‚
â”‚                  â”‚                 â”‚ â”‚ [Remove]  â”‚â”‚
â”‚                  â”‚                 â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                  â”‚                 â”‚               â”‚
â”‚                  â”‚                 â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚                  â”‚                 â”‚ â”‚[Export]   â”‚â”‚
â”‚                  â”‚                 â”‚ â”‚[Print]    â”‚â”‚
â”‚                  â”‚                 â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”— Module Dependencies

```
@angular/core
    â”‚
    â”œâ”€â”€ BrowserModule
    â”œâ”€â”€ BrowserAnimationsModule
    â””â”€â”€ FormsModule, ReactiveFormsModule
            â”‚
            â”œâ”€â”€ PharmacyModule
            â”‚    â”‚
            â”‚    â”œâ”€â”€ PharmaComponentsModule
            â”‚    â”‚    â”‚
            â”‚    â”‚    â”œâ”€â”€ CommonModule
            â”‚    â”‚    â”œâ”€â”€ ReactiveFormsModule
            â”‚    â”‚    â””â”€â”€ [13 Material Modules]
            â”‚    â”‚
            â”‚    â””â”€â”€ PharmaRoutingModule
            â”‚
            â””â”€â”€ @angular/material modules
                    â”‚
                    â”œâ”€â”€ MatButtonModule
                    â”œâ”€â”€ MatCardModule
                    â”œâ”€â”€ MatFormFieldModule
                    â”œâ”€â”€ MatInputModule
                    â”œâ”€â”€ MatIconModule
                    â”œâ”€â”€ MatListModule
                    â”œâ”€â”€ MatTabsModule
                    â”œâ”€â”€ MatProgressBarModule
                    â”œâ”€â”€ MatChipsModule
                    â”œâ”€â”€ MatTooltipModule
                    â”œâ”€â”€ MatSnackBarModule
                    â”œâ”€â”€ MatExpansionModule
                    â””â”€â”€ MatTableModule

External Libraries:
    â”‚
    â”œâ”€â”€ @tensorflow/tfjs
    â”‚    â””â”€â”€ @tensorflow-models/coco-ssd
    â”‚
    â””â”€â”€ rxjs
         â””â”€â”€ Observable, BehaviorSubject
```

---

## ğŸ’¾ LocalStorage Structure

```
browser.localStorage
    â”‚
    â””â”€â”€ Key: "visual_spaces"
         â”‚
         Value: JSON String
         â”‚
         â–¼
         [
           {
             id: "string",
             name: "Aisle 1",
             location: "Front of Store",
             imageUrl: "data:image/...",
             shelves: [
               {
                 id: "string",
                 name: "Shelf A",
                 location: "Front",
                 width: 100,
                 height: 50,
                 medicines: [
                   {
                     id: "string",
                     name: "Aspirin",
                     barcode: "...",
                     x: 25,
                     y: 15,
                     width: 8,
                     height: 10,
                     confidence: 0.95,
                     shelfId: "string",
                     detectionTime: "2024-12-20T..."
                   },
                   ...more medicines...
                 ]
               },
               ...more shelves...
             ],
             createdDate: "2024-12-20T...",
             lastUpdated: "2024-12-20T..."
           },
           ...more spaces...
         ]
```

---

## ğŸ”€ State Management with RxJS

```
Service Layer
    â”‚
    â”œâ”€â”€ BehaviorSubject<VisualSpace[]>
    â”‚   â””â”€â”€ getVisualSpaces(): Observable<VisualSpace[]>
    â”‚       â””â”€â”€ Subscribed by: All Components
    â”‚
    â”œâ”€â”€ BehaviorSubject<VisualSpace | null>
    â”‚   â””â”€â”€ getCurrentVisualSpace(): Observable<VisualSpace | null>
    â”‚       â””â”€â”€ Subscribed by: ShelfManagement, VisualMapper
    â”‚
    â”œâ”€â”€ BehaviorSubject<Shelf | null>
    â”‚   â””â”€â”€ getCurrentShelf(): Observable<Shelf | null>
    â”‚       â””â”€â”€ Subscribed by: MedicineDetection, ShelfManagement
    â”‚
    â””â”€â”€ (Detection Service)
        â”œâ”€â”€ BehaviorSubject<DetectionResult | null>
        â”‚   â””â”€â”€ getDetectionResults(): Observable
        â”‚
        â””â”€â”€ BehaviorSubject<boolean>
            â””â”€â”€ getLoadingState(): Observable<boolean>
```

---

## ğŸš€ Request/Response Example

### User Creates Visual Space

```
User Input:
  â”œâ”€â”€ Space Name: "Main Aisle"
  â”œâ”€â”€ Location: "Store Front"
  â””â”€â”€ Image: [File upload]

  â†“ Processing

Component receives input
  â””â”€â”€ Validates form

  â†“ Service Call

ShelfMappingService.createVisualSpace(
  name: "Main Aisle",
  location: "Store Front",
  imageUrl: "data:image/..."
)

  â†“ Service Processing

Creates VisualSpace object:
  {
    id: "abc123",
    name: "Main Aisle",
    location: "Store Front",
    imageUrl: "data:image/...",
    shelves: [],
    createdDate: Date.now(),
    lastUpdated: Date.now()
  }

  â†“ Persist

Save to LocalStorage
  â””â”€â”€ Key: "visual_spaces"
  â””â”€â”€ Stringified JSON

  â†“ Update State

BehaviorSubject emits new value
  â””â”€â”€ All subscribers receive update

  â†“ UI Update

Component receives updated spaces
  â””â”€â”€ Renders new space in list
  â””â”€â”€ Shows success message
```

---

## ğŸ“ˆ Performance Flow

```
Initial Load (First Time)
    â”œâ”€â”€ Load Angular App: ~2 sec
    â”œâ”€â”€ Download COCO-SSD Model: ~30 sec
    â”‚   (100MB, cached after first time)
    â””â”€â”€ Ready for detection: ~32 sec total

Subsequent Detection
    â”œâ”€â”€ Image Analysis: ~2-5 sec
    â””â”€â”€ Results Display: ~100ms

Data Operations
    â”œâ”€â”€ Add/Remove Medicine: <100ms
    â”œâ”€â”€ LocalStorage Save: <50ms
    â””â”€â”€ UI Update (Observable): <200ms
```

---

## ğŸ” Security & Isolation

```
Browser Environment
    â”‚
    â””â”€â”€ Application Sandbox
         â”‚
         â”œâ”€â”€ Components (Cannot access system)
         â”œâ”€â”€ Services (Cannot access system)
         â””â”€â”€ Data (Limited to LocalStorage/RAM)
                â”‚
                â”œâ”€â”€ No server calls (offline capable)
                â”œâ”€â”€ No file system access
                â”œâ”€â”€ No external API calls
                â””â”€â”€ User data stays on device
```

---

This comprehensive visual guide helps understand:
- System architecture
- Data flow
- Component hierarchy
- Service communication
- State management
- UI layout structure
- Performance characteristics
- Storage structure

Refer to these diagrams while reading the code to better understand how everything connects together!

**Next**: Read [API_DOCUMENTATION.md](./API_DOCUMENTATION.md) for detailed API reference.
